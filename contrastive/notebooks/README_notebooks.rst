Notebooks Readme
################

Subfolders
==========

archives
--------
Where old notebooks are stored. They are either deprecated or highly linked to a specific publication.

flanker_analysis
----------------
Notebooks used by Joël to perform the analysis of his grid searches on the Flanker test.

methods
-------
These notebooks are related to tests or implementation of a method supposed to improve the pipeline. Unlike in technical_tests, **these notebooks contains relevant results** that made us choose between methods, or that showed the benefit of a method.

schiz_db
--------
These notebooks are related to the database schiz, which is the fusion of bsnip1, candi, cnp and schizconnect-vip-prague. They are used for analysis or preprocessing of that database specifically.

technical_tests
---------------
These notebooks are only used as tests to see if an implementation works as intended. It shouldn't contain any results that are scientifically relevant. They are kept as evidence that the methods work.

wandb_grid_searches
-------------------
These notebooks contain relevant analyses about the region supervised grid searches. There are three subfolders, each correponding to a step in the process described in the following `google doc <https://docs.google.com/document/d/1nHdpBxwbeNGOUe1X8_b0p1EFpDop-KtEvjPXtdOBj04/edit?usp=sharing>`_. 



Individual notebooks
====================

(*) notebooks are the important ones, either by the results they contain or by the fact that they implement methods used by other programs.

03-analysis_effect_of_n
-----------------------
Analysis of the effect of the training set size and a faw other parameters (such as batch size).

bdd_analysis (*)
----------------
Notebook that loads a database generated by ``evaluation/generate_bdd.py``, where relevant information of trained models is stored. Some analysis about the link between model performance and train data gyrification, time efficiency or validation loss are then performed.

methods/check_svm_consistency
-----------------------------
Notebook to check if svm are consistent, i.e. if they converge and how fast. This question was risen because of the highly fluctuating results of the whole pipeline under a certain validation loss.

count_voxels (*)
----------------
Notebook to visualize information about gyrification for datasets throuigh the number of voxels in a normalized space. This notebooks also contains codes to generate gyrification based subsets (like the most or least folded subsets of a dataset).

fusion_schiz_bases
------------------
**/!\\ It has been moved to preprocessing instead of notebooks.**
Notebook to fusion bsnip1, candi, cnp and schizconnect in one database nammed schiz. Please look at the google doc `Travail base de données schizophrène <https://docs.google.com/document/d/1gZlVMdki9cX2n5Y8Kobizoc9HGE27eoUo6NFIkecC-c/edit?usp=sharing>`_ for more information.

technical_tests/optimize_transforms
-----------------------------------
Notebook to compare and decrease computation time of SimCLR augmentations.

paracingulate_analysis
----------------------
Localisation of paracingulate (and proeminent ones) in the latent space.

technical_tests/test_scaling
----------------------------
Notebook to test which scaler to add before running the classification.

visualize_flanker_results
-------------------------
Notebook to generate the color map of brain sulci with anatomist ; used for grid search visualization.



methods
=======

captum_GradCam
--------------
Notebook to generate and visualize gradcam for the paracingulate detection.

check_svm_consistency
---------------------
Check the number of epochs SVM take to converge + their noise resistance.

test_init
---------
Compares performance depending on the weights initialisation.


schiz_db
========

early_schiz_analysis
--------------------
First analyses on the schiz database. Not that relevant anymore.

morpho_schiz
------------
Treating the morphometric parameters of the cingulate region (of the schiz database) in order to train SVM on them. Both results and morphometric parameters are stored at "/neurospin/dico/data/deep_folding/current/datasets/schiz/morphometry_statistics".

PCA_on_schiz
------------
Same as morpho_schiz, but to directly apply a PCA on the cingulate crops. Both the generated embeddings and the corresponding results are stored at "/neurospin/dico/data/deep_folding/current/datasets/schiz/crops/2mm/CINGULATE/mask/pca".

schiz_investigation
-------------------
Visualisation of the cingulate of the schiz database's, through models outputs and predictions.

supervised_schiz_side_analysis
------------------------------
Not so clear what is going on here. Probably a side comparison of predictions for cingulate on schiz, but through strip plots of the models probabilities.


wandb_grid_searches
===================

step1/ACC_presearch
-------------------
Structure grid search on the paracingulate detection.

step1/gs_crit
-------------
Results on the first regions (cingulate, S.or; and S.T.s.). Comparison of perfs, study of hyperparameters influence on performance and gs criterion.

step1/side_comparison
---------------------
Compaison of performance with only the right hemisphere, only the left or both. Conclusions are that both are at least as fine as only one.


step2/monitoring_collisions
---------------------------
A small notebook made to know where collisions happen (collision = when two models are saved innn the same exact folder). Also allows to compute easily the config diff and rename the subfolders for region according to the chosen rule (both and both2).

step2/new_regions_partition
---------------------------
Notebook used to help define the regions used for gridsearches. Check if all sulci are at least in one region and in how many regions they appear.


step3/best_subjects_visu
------------------------
Notebook helping to choose which subject should be visualized. Based on ensemble model's predictions.

step3/ensemble_models
---------------------
Notebook to generate, save and analyse ensemble models, i.e. models that aggregate the predictions of all 60 models of a region. Also implement the bootstrap on ensemble models.

step3/lien_voxels_pred_occipital
--------------------------------
Check the number of voxels in the crop of occipital for the schiz database, and compare it to true label (schizophrenia) and model preidctions.

step3/occipital_gs
------------------
Contains post main grid searches analyses concerning occipital, i.e. structural grid search on occipital, structural and hyperparam grid search with densenet, and grid search on recropped occipital.

step3/region_comparison (*)
---------------------------
Notebook with the main results about the grid search, as it contains the histograms of each region's AUC. It also contains the analysis about the size of regions (and its correlation with performance).
